<!-- results.handlebars V.1.2 -->
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="FlyTED2 results page">
    <meta name="keywords" content="HTML,CSS,XML,JavaScript,Drosophilla,Database">
    <meta name="author" content="Benedict Uttley, Cardiff University, Biosciences">
    <title>Query Results</title>

    <!--Load jquery-->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous">
    </script>
    <!-- Load the Bootstrap js files -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/js/bootstrap.min.js" integrity="sha384-o+RDsa0aLu++PJvFqy8fFScvbHFLtbvScb8AjopnFD+iEQ7wo/CG0xlczd+2O/em" crossorigin="anonymous">
    </script>
    <!-- Load the jQuery reduced library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.3.5/jquery.fancybox.min.js"></script>
    <!--Load the API for google charts -->
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <!-- Load the Bootstrap css files -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/css/bootstrap.min.css" integrity="sha384-Smlep5jCw/wG7hdkwQ/Z5nLIefveQRIY9nfy6xoR1uRYBtpZgI6339F5dgvm/e9B" crossorigin="anonymous">
    </link>
    <!-- Load the Fancybox css files -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.3.5/jquery.fancybox.min.css"></link>
    <link href="https://fonts.googleapis.com/css?family=Noto+Sans" rel="stylesheet">
    <!-- LOAD EXTERNAL JS SCRIPTS -->
    <script type="text/javascript" src="sidebar.js"></script>
    <script type="text/javascript" src="table.js"></script>
    <script type="text/javascript" src="create_chart_queries.js"></script>
    <script type="text/javascript" src="draw_graphs.js"></script>
    <script type="text/javascript" src="create_chart_containers.js"></script>
    <script type="text/javascript" src="transcripts.js"></script>
    <script type="text/javascript" src="error_handlers.js"></script>


    <style>
    :root{--blue:#007bff;--indigo:#6610f2;--purple:#6f42c1;--pink:#e83e8c;--red:#dc3545;--orange:#fd7e14;--yellow:#ffc107;--green:#28a745;--teal:#20c997;--cyan:#17a2b8;--white:#fff;--gray:#6c757d;--gray-dark:#343a40;--primary:#007bff;--secondary:#6c757d;--success:#28a745;--info:#17a2b8;--warning:#ffc107;--danger:#dc3545;--light:#f8f9fa;--dark:#343a40;--breakpoint-xs:0;--breakpoint-sm:576px;--breakpoint-md:768px;--breakpoint-lg:992px;--breakpoint-xl:1200px;--font-family-sans-serif:-apple-syste
    m,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--font-family-monospace:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}*,::after,::before{box-sizing:border-box}html{font-family:sans-serif;line-height:1.15;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;-ms-overflow-style:scrollbar}@-ms-viewport{width:device-width}nav{display:block}body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;text-align:left;background-color:#fff}h2,h3{margin-top:0;margin-bottom:.5rem}ul{margin-top:0;margin-bottom:1rem}a{color:#007bff;text-decoration:none;background-color:transparent;-webkit-text-decoration-skip:objects}a:not([href]):not([tabindex]){color:inherit;text-decoration:none}label{display:inline-block;margin-bottom:.5rem}button{border-radius:0}button,input{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,input{overflow:visible}button{text-transform:none}[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{padding:0;border-style:none}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}h2,h3{margin-bottom:.5rem;font-family:inherit;font-weight:500;line-height:1.2;color:inherit}h2{font-size:2rem}h3{font-size:1.75rem}.container{width:100%;padding-right:15px;padding-left:15px;margin-right:auto;margin-left:auto}@media (min-width:576px){.container{max-width:540px}}@media (min-width:768px){.container{max-width:720px}}@media (min-width:992px){.container{max-width:960px}}@media (min-width:1200px){.container{max-width:1140px}}.col-sm-10,.col-sm-2{position:relative;width:100%;min-height:1px;padding-right:15px;padding-left:15px}@media (min-width:576px){.col-sm-2{-ms-flex:0 0 16.666667%;flex:0 0 16.666667%;max-width:16.666667%}.col-sm-10{-ms-flex:0 0 83.333333%;flex:0 0 83.333333%;max-width:83.333333%}}.form-control{display:block;width:100%;padding:.375rem .75rem;font-size:1rem;line-height:1.5;color:#495057;background-color:#fff;background-clip:padding-box;border:1px solid #ced4da;border-radius:.25rem}.form-control::-ms-expand{background-color:transparent;border:0}.form-control::-webkit-input-placeholder{color:#6c757d;opacity:1}.form-control::-moz-placeholder{color:#6c757d;opacity:1}.form-control:-ms-input-placeholder{color:#6c757d;opacity:1}.form-control::-ms-input-placeholder{color:#6c757d;opacity:1}.form-group{margin-bottom:1rem}.btn{display:inline-block;font-weight:400;text-align:center;white-space:nowrap;vertical-align:middle;border:1px solid transparent;padding:.375rem .75rem;font-size:1rem;line-height:1.5;border-radius:.25rem}.btn-lg{padding:.5rem 1rem;font-size:1.25rem;line-height:1.5;border-radius:.3rem}.collapse:not(.show){display:none}.nav{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;padding-left:0;margin-bottom:0;list-style:none}.nav-link{display:block;padding:.5rem 1rem}.navbar{position:relative;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-ms-flex-align:center;align-items:center;-ms-flex-pack:justify;justify-content:space-between;padding:.5rem 1rem}.navbar-nav{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;padding-left:0;margin-bottom:0;list-style:none}.navbar-nav .nav-link{padding-right:0;padding-left:0}.navbar-collapse{-ms-flex-preferred-size:100%;flex-basis:100%;-ms-flex-positive:1;flex-grow:1;-ms-flex-align:center;align-items:center}.navbar-toggler{padding:.25rem .75rem;font-size:1.25rem;line-height:1;background-color:transparent;border:1px solid transparent;border-radius:.25rem}.navbar-toggler-icon{display:inline-block;width:1.5em;height:1.5em;vertical-align:middle;content:"";background:no-repeat center center;background-size:100% 100%}@media (min-width:576px){.navbar-expand-sm{-ms-flex-flow:row nowrap;flex-flow:row nowrap;-ms-flex-pack:start;justify-content:flex-start}.navbar-expand-sm .navbar-nav{-ms-flex-direction:row;flex-direction:row}.navbar-expand-sm .navbar-nav .nav-link{padding-right:.5rem;padding-left:.5rem}.navbar-expand-sm .navbar-collapse{display:-ms-flexbox!important;display:flex!important;-ms-flex-preferred-size:auto;flex-basis:auto}.navbar-expand-sm .navbar-toggler{display:none}}.navbar-dark .navbar-nav .nav-link{color:rgba(255,255,255,.5)}.navbar-dark .navbar-nav .active>.nav-link{color:#fff}.navbar-dark .navbar-toggler{color:rgba(255,255,255,.5);border-color:rgba(255,255,255,.1)}.navbar-dark .navbar-toggler-icon{background-image:url("data:image/svg+xml;charset=utf8,%3Csvg viewBox='0 0 30 30' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath stroke='rgba(255, 255, 255, 0.5)' stroke-width='2' stroke-linecap='round' stroke-miterlimit='10' d='M4 7h22M4 15h22M4 23h22'/%3E%3C/svg%3E")}.bg-primary{background-color:#007bff!important}.fixed-top{position:fixed;top:0;right:0;left:0;z-index:1030}.sr-only{position:absolute;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}.mr-auto{margin-right:auto!important}.ml-auto{margin-left:auto!important}
   </style>
   <style>
   * {
       box-sizing: border-box;
   }

   .header {
       text-align: center;
       padding: 32px;
   }

   .row {
       display: -ms-flexbox; /* IE10 */
       display: flex;
       -ms-flex-wrap: wrap; /* IE10 */
       flex-wrap: wrap;
       padding: 0 4px;
   }

   /* Create four equal columns that sits next to each other */
   .column {
       -ms-flex: 25%; /* IE10 */
       flex: 25%;
       max-width: 25%;
       padding: 0 4px;
   }

   .column img {
       margin-top: 8px;
       vertical-align: middle;
   }

   /* Responsive layout - makes a two column-layout instead of four columns */
   @media screen and (max-width: 800px) {
       .column {
           -ms-flex: 50%;
           flex: 50%;
           max-width: 50%;
       }
   }

   /* Responsive layout - makes the two columns stack on top of each other instead of next to each other */
   @media screen and (max-width: 600px) {
       .column {
           -ms-flex: 100%;
           flex: 100%;
           max-width: 100%;
       }
   }
   </style>

    <style>
    .tab, .tab2 {
        margin-top: 8px;
        width: 100%;
        background-color: gray;
        color: white;
        cursor: pointer;
        padding: 5px;
        height: auto;
      }


     body{
      padding-top: 50px;
      background-color: white;
      font-family: 'Noto Sans', sans-serif;
     }
      .key {
        font-weight: bold;
      }

      .tab:hover {
        background-color: #d4374a;
      }

      .tab2:hover {
        background-color: #4286f4;
      }


      .qbox {
        position: fixed;
        top: 20px;
        right: 50px;
      }


      .Up {
        border: solid green;
        border-width: 0 3px 3px 0;
        display: inline-block;
        padding: 3px;
        transform: rotate(-135deg);
        -webkit-transform: rotate(-135deg);
      }

      .Down {
        border: solid red;
        border-width: 0 3px 3px 0;
        display: inline-block;
        padding: 3px;
        transform: rotate(45deg);
        -webkit-transform: rotate(45deg);
      }

      .content {
        position: relative;
        height: 100%;
        width: 100%;
        padding: 5%;
      }

      .flytedContainer {
        padding: 5px;
        width: 100%;
        height: 75%;
      }

      .image {
        position: relative;
        float: left;
        width: 50%;
        height: 100%;
        background-color: yellow;
        border: 2px solid black;
      }

      .annotation {
        position: relative;
        float: right;
        width: 50%;
        height: 100%;
        color: white;
      }

      .key {
        font-weight: bold;
      }

      .form-control:focus {
        border-color: #d4374a;
        box-shadow: 0px 1px 1px #d4374a inset, 0px 0px 8px #d4374a;
      }

      .square {
        position: relative;
        width: 100%;
        border: 3px solid black;
        height: 40%;
      }

      .square:after {
        content: "";
        display: block;
        padding-bottom: 40%;
      }

      .contenta {
        position: absolute;
        width: 50%;
        height: 100%;
        right: 0%;
      }

      .contentb {
        position: absolute;
        width: 50%;
        height: 100%;
        left: 0%;
      }

      /**************************
    DEFAULT BOOTSTRAP STYLES
    **************************/

      .btn {
        display: inline-block;
        padding: 6px 12px;
        margin-bottom: 0;
        font-size: 14px;
        font-weight: normal;
        line-height: 1.42857143;
        text-align: center;
        white-space: nowrap;
        vertical-align: middle;
        cursor: pointer;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        background-image: none;
        border: 1px solid transparent;
        border-radius: 4px;
        padding: 10px 16px;
      }

      .btn-lg {
        font-size: 18px;
        line-height: 1.33;
        border-radius: 6px;
      }

      .btn-primary {
        color: white;
        background-color: white;
        border-color: white;
      }

      .btn-primary:hover,
      .btn-primary:focus,
      .btn-primary:active,
      .btn-primary.active,
      .open .dropdown-toggle.btn-primary {
        color: white;
        background-color: white;
        border-color: white;
      }

      /***********************
    SHARP BUTTONS
    ************************/

      .sharp {
        border-radius: 0;
      }

      /***********************
    CUSTON BTN VALUES
    ************************/

      .btn {

        border: 0 none;
        font-weight: 700;
        letter-spacing: 1px;
        text-transform: uppercase;
        outline: none !important;
      }

      .btn:focus,
      .btn:active:focus,
      .btn.active:focus {
        outline: none !important;
      }

      .btn {
        background: white;
        color: #d4374a;
         border-radius:0;
        outline: none !important;
      }

      .btn:hover,
      .btn-primary:focus,
      .btn-primary:active,
      .btn-primary.active,
      .open>.dropdown-toggle.btn-primary {
        background: #d4374a;
        color: white;
        outline: none !important;
      }

      .btn:active,
      .btn.active {
        outline: none !important;
        background: black;
        box-shadow: none;
      }

      .btn:focus {
        outline: none !important;
      }

      .btn:focus,
      .btn:active {
        outline: none !important;
        box-shadow: none !important;
      }



    </style>



  <!-- THE HOME STYING -->
  <style>
  .content {
    position: absolute;
    background-color: white;
    width: 100%;
    height: 100%;
  }

  .main_info {
    position: relative;
    display: inline-block;
    background-color: grey;
    padding:1%;
    border: 2px solid white;
    color: white
  }

  .data_acquisition_info {
    margin-top: 5%;
    position: relative;
    display: inline-block;
    background-color: grey;
    padding:1%;
    border: 2px solid white;
    color: white
  }

  </style>
  <style>

      .sidenav {
        top: 25%;
        height: 40%;
        width: 250px;
        position: fixed;
        z-index: 100;
        left: 0;
        overflow-x: hidden;
        transition: 0.5s;
        padding-top: 15px;
        background-color: gray;
        border-top: 2px solid white;
        border-bottom: 2px solid white;
        border-right: 2px solid white;
      }

      .sidenav .closebtn {
        background-color: black;
        position: absolute;
        top: 0;
        right: 25px;
        font-size: 36px;
        margin-left: 50px;
        cursor: pointer;
      }
      .sidenav .closebtn:hover {
        background-color: #d4374a;
        position: absolute;
        top: 0;
        right: 25px;
        font-size: 36px;
        margin-left: 50px;
        cursor: pointer;
      }

  </style>

  <!-- LOAD EXTERNAL CSS SHEETS -->
  <link rel="stylesheet" href="table.css"></link>
  <link rel="stylesheet" href="side_bar.css"></link>
  <link rel="stylesheet" href="main.css"></link>

<style>
.gene_link {
  color: white;
  background-color: #d4374a;
  height: 100%;
}

.gene_link:hover {
  color: white;
  text-decoration: underline;
  background-color: #d4374a;
}

.btn-link {
  float: right;
  border: 0 none;
  font-weight: 700;
  letter-spacing: 1px;
  text-transform: uppercase;
  outline: none !important;
  color:#d4374a;
}

.btn-link:hover {
  color:#d4374a;
  text-decoration: underline;
}
</style>

  </head>

  <body>

    <!--Side bar containing query bulder form -->
    <div id="mySidenav" class="sidenav">
      <div class="container">
        <a class="closebtn" onclick="closeNav()" style="color: white" onclick="toggleSide()">&times</a>
        <br>
        <form class="form-horizontal" method="post" action="/results">
          <h3 style="color:white">Query Builder</h3>
          <div class="form-group">
            <label class="control-label col-sm-2" style="color: white">GENE</label>
            <div class="col-sm-10">
              <input class="form-control" id="gene" name="Probe" placeholder="Enter gene(s)" data-toggle="tooltip" data-placement="left" title="Seperate multiple genes with commas.">
            </div>
          </div>
          <div class="form-group">
            <label class="control-label col-sm-2" style="color: white">VARIANT</label>
            <div class="col-sm-10">
              <input class="form-control" id="variant" name="Variant" placeholder="Enter Variant(s)" data-toggle="tooltip" data-placement="left" title="Seperate multiple genotypes with commas.">
            </div>
          </div>
          <br>
          <div class="form-group">
            <div class="col-sm-offset-2 col-sm-10">
              <button type="submit" class="btn btn-lg sharp" style="width:100%">EXECUTE</button>
            </div>
          </div>
        </form>
      </div>
    </div>

    <!--Top sticky navigation bar -->
    <nav class="navbar navbar-expand-sm navbar-dark bg-primary fixed-top" style="background-color: gray !important; border-bottom: 2px solid white">
      <button class="btn btn-info navbar-btn" onclick="toggleSide()">New Query</button>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarText" aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarText">
        <ul class="nav navbar-nav mr-auto">
          <li class="nav-item">
            <a style="color: white" class="nav-link">FlyTED2</a>
          </li>
        </ul>
        <ul class="nav navbar-nav">
          <li class="nav-item">
            <!-- <button type="button" class="btn btn-lg sharp" onclick="toggleSide()">SEARCH</button> -->
            </li>
        </ul>
        <ul class="navbar-nav ml-auto">
          <li class="nav-item">
            <a class="nav-link" href="/home">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/credits">Credits</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/cite">Liscence and Citing</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/admin">Admin</a>
          </li>
        </ul>
      </div>
    </nav>

    <!-- GLOBAL VARIABLES DECLARATION START -->
    <script>
    var microarray_data_present = true; // Store whether microarray data has been retrieved or not.
    var tissue_expression_present = true; // Store whether flymine data has been retrieved or not.
    var transcipt_expression_present = true; // Store whether flymine data has been retrieved or not.
    var image_data_present = true; // Store whether image data has been retrieved or not.
    var gene = "none"; // Stores gene id of curent loop.
    var data_array = []; // Holds the tissue expression data from flymine.
    var affy_array = []; // Holds the affy data from sql table 'Probe Annotations'.
    </script>
    <!-- GLOBAL VARIABLES DECLARATION END -->

    {{#each flyMineData}}

      <!-- CHECK IF DATA COMPONENTS AVAILABLE START -->
      <script>
        Check_For_Data_Components({{{json [affy]}}}, {{{json [tissue]}}}, {{{json [transcript]}}}, {{{json [flyted]}}});
      </script>
      <!-- CHECK IF DATA COMPONENTS AVAILABLE END -->

      <div class="content">
        <!-- INCLUDE FLYBASE LINK FOR GENE -->
        <h1 style="background-color:#d4374a; color:white;">RESULT FOR GENE: {{[probe]}}

        </h1>
        <a href="http://flybase.org/reports/{{this.[tissue].[0].[9]}}" class="gene_link">Link To FlyBase Report For Gene
        </a>
        <br>
        <br>

        <!---DISPLAY TRANSCRIPTS HEADER START -->
        <script>
          if (transcipt_expression_present) {
            Create_Transcript_Header();
          }
        </script>
        <!---DISPLAY TRANSCRIPTS HEADER END -->

        <!-- LOOP THROUGH TRANSCRIPT DATA START -->
        {{#each [transcript]}}
          {{#with this}}
            <div class="tab" id="temp"></div>

            <!-- CREATE TAB BUTTON FOR TRANSCRIPT START -->
            <script>
              Create_Transcript_Tab("{{[Transcript_ID]}}");
            </script>
            <!-- CREATE TAB BUTTON FOR TRANSCRIPT END -->

            <!-- CREATE TRANSCRIPT CONTENTS CONTAINER START -->
            <div id="{{[Transcript_ID]}}_container" style="padding:2%; border: 2px solid black">
              <!-- TRANSCRIPT INFORMATION START -->
              <p>
                <font color='#d4374a'>Transcript Primary ID: </font> {{[Transcript_ID]}}
                <a href="http://flybase.org/reports/{{[Transcript_ID]}}" class="btn-link">Link To FlyBase Report For This Transcript
                </a>
              </p>
              <p>
                <font color='#d4374a'>Length of Transcript:</font> {{[Transcript_Sequence_Length]}}
              </p>
              <h5 style="color:#d4374a">Transcript Sequence</h5>
              <div wrap="hard" style="overflow-wrap: break-word; width:100%">
                {{[Transcript_Sequence]}}
              </div>
              <!-- TRANSCRIPT INFORMATION END -->
              <!-- PROBE INFORMATION START-->
              <br>
              <p>
                <font color='#d4374a'>Probe 5' Sequence: </font>
                <span style="color: #660066; text-decoration: underline overline; font-weight: bold;">{{[5_Prime_Sequence]}}</span>
              </p>
              <p>
                <font color='#d4374a'>Probe 3' Sequence: </font>
                <span style="color: #009933; text-decoration: underline overline; font-weight: bold;">{{[3_Prime_Sequence]}}</span>
              </p>
              <p>
                <font color='#d4374a'>Probe Length: </font> {{[Target_Sequence_Length]}}
              </p>
              <h5 style="color:#d4374a">Probe Sequence</h5>
              <div id="{{[Transcript_ID]}}" wrap="hard" style="overflow-wrap: break-word; width:100%">
                {{[Target_Sequence]}}
              </div>
              <!-- PROBE INFORMATION END-->
            </div>
            <!-- CREATE TRANSCRIPT CONTENTS CONTAINER END -->

            <!-- EDIT STYLE OF SEQUENCES TO SHOW 5' AND 3' PROBES START -->
            <script>
              show_probes("{{Transcript_ID}}", "{{3_Prime_Sequence}}", "{{5_Prime_Sequence}}");
            </script>
            <!-- EDIT STYLE OF SEQUENCES TO SHOW 5' AND 3' PROBES END -->

          {{/with}}
        {{/each}}
        <!-- LOOP THROUGH TRANSCRIPT DATA END -->

        <br>
        <h2 style="color:#d4374a" id="{{probe}}_image_title">IMAGES AND THEIR DESCRIPTIONS</h2>

        <!-- HANDLE CASE WHERE NO IMAGE DATA PRESENT FOR GENE START -->
        <script>
          if (!image_data_present) {
            Handle_No_Image_Data("{{probe}}");
          }
        </script>
        <!-- HANDLE CASE WHERE NO IMAGE DATA PRESENT FOR GENE END -->

        <!-- LOOP THGROUGH SQL ANNOTAIONS AND IMAGES DATA START-->
        {{#each [flyted]}}
          <div class="square">
            <a class="contenta" data-fancybox="gallery" href="{{[link_to_file]}}" style="background: url('{{[link_to_file]}}'), url('img/image_error.bmp'); overflow: hidden; background-size: cover;  background-position: center">
            </a>
            <!-- Liscence for fancybox can be found on their site -> https://fancyapps.com/fancybox/3
            It is free to use fancyBox for your personal or non-profit website projects. This website is non-profit.
            fancybox is released under the GNU General Public License v3.0 -->

            <script>
              $("[data-fancybox]").fancybox({
                arrows: false,
                thumbs: {
                  autoStart: true
                },
                buttons: [
                  "close"
                ],
              });
            </script>

            {{#with this}}
              <!-- TABLE TO SHOW IMAGES AND RESPECTIVE ANNOTATIONS START -->
              <div class="contentb" style="overflow:auto">
                <table class="table table-bordered" style="position: relative; width:100%; height:100%; margin:0px">
                  <tbody>
                    <tr>
                      <td class="key">Probe</td>
                      <td>{{[probe]}}</td>
                    </tr>
                    <tr>
                      <td class="key">Slide Name</td>
                      <td>{{[slide_name]}}</td>
                    </tr>
                    <tr>
                      <td class="key">Genotype A</td>
                      <td>{{[genotype_a]}}</td>
                    </tr>
                    <tr>
                      <td class="key">Genotype B</td>
                      <td>{{[genotype_b]}}</td>
                    </tr>
                    <tr>
                      <td class="key">Stages Shown</td>
                      <td>{{[stages_shown_in_picture]}}</td>
                    </tr>
                    <tr>
                      <td class="key">Description</td>
                      <td>{{[description_of_staining_pattern]}}</td>
                    </tr>
                    <tr>
                      <td class="key">Apical/spermatogonia</td>
                      <td>{{[Apical_spermatogonia]}}</td>
                    </tr>
                    <tr>
                      <td class="key">Germ-line</td>
                      <td>{{[Germ_line]}}</td>
                    </tr>
                    <tr>
                      <td class="key">Somatic</td>
                      <td>{{[Somatic]}}</td>
                    </tr>
                    <tr>
                      <td class="key">Additional Comments</td>
                      <td>{{[comments]}}</td>
                    </tr>
                  </tbody>
                </table>
              </div>
              <!-- TABLE TO SHOW IMAGES AND RESPECTIVE ANNOTATIONS END -->
            {{/with}}
          </div>
          <br>
        {{/each}}
        <!-- LOOP THGROUGH SQL ANNOTAIONS AND IMAGES DATA END-->
        <h2 style="color:#4286f4" id="microarray_{{[probe]}}">MICROARRAY GRAPH AND ANNOTATIONS</h2>
        <!-- TABLE TO SHOW ADDITIONAL PROBE ANNOTTAIONS FROM THE 'PROBE_ANNOTATIONS' TABLE IN SQL START -->
        <table id="annotation_for_{{[probe]}}" class="expression_table">
          <tbody>
            <tr>
              <td data-field="key" class="key">Gene</td>
              <td data-field="value"></td>
            </tr>
            <tr>
              <td data-field="key" class="key">Probe Set ID</td>
              <td data-field="value">
            </tr>
            <tr>
              <td data-field="key" class="key">Transcript ID</td>
              <td data-field="value"></td>
            </tr>
            <tr>
              <td data-field="key" class="key">Description</td>
              <td data-field="value"></td>
            </tr>
          </tbody>
        </table>
        <!-- TABLE TO SHOW ADDITIONAL PROBE ANNOTTAIONS FROM THE 'PROBE_ANNOTATIONS' TABLE IN SQL END -->

        <!-- CREATE THE CHART CONTAINER AND BUTTON FOR AFFY DATA START -->
        <script>
          if (microarray_data_present) {
            create_affy_container("{{[probe]}}");
          }
        </script>
        <!-- CREATE THE CHART CONTAINER AND BUTTON FOR AFFY DATA END -->

        <!--CREATE FORM USED FOR SEARCHING AND SORTING THE TISSUE EXPRESSION TABLE START -->
        <h2 style="color: #d4374a" id="expression_title_{{[probe]}}">EXPRESSION IN TISSUES</h2>
        <div id="expression_form_{{[probe]}}" style="position:relative">
            <div class="form-inline">
            <label for="search">Search:</label>
            <input type="text" name="search" id="myInput" onkeyup="SearchTable(this.id)" placeholder="Search by Tissue" title="Filter Table" class="form-control" style="margin: 10px">
          </div>
          <div class="form-inline">
            <label style="margin:10px">Order:</label>
            <div class="btn-group btn-group-toggle" data-toggle="buttons">
              <label class="btn btn-lg sharp">
                <input type="radio" name="options" id="myButton_asc" autocomplete="off" onclick="sortTable(this.id, 'asc')"> Ascending
              </label>
              <label class="btn btn-lg sharp">
                <input type="radio" name="options" id="myButton_desc" autocomplete="off" onclick="sortTable(this.id, 'desc')"> Descending
              </label>
            </div>
          </div>
        </div>
        <!--CREATE FORM USED FOR SEARCHING AND SORTING THE TISSUE EXPRESSION TABLE END -->
        <br>
        <div style="position: relative; width: 100%; overflow: auto">
          <!-- CREATE TABLE TO CONTAIN TISSUE EXPRESSION RESULTS FROM FLYMIN API START -->
          <table id="myTable" style="width: 100%" class="expression_table">

            <!-- SET ID OF TABLE IN RESPECT TO GENE START -->
            <script>
              Set_Table_ID("{{[probe]}}");
            </script>
            <!-- SET ID OF TABLE IN RESPECT TO GENE END -->

            <!-- DECLARE TABLE HEADERS START -->
            <tr>
              <th>Gene Secondary Identifier</th>
              <th>Gene Symbol</th>
              <th>mRNA Signal</th>
              <th>mRNA Signal SEM</th>
              <th>Present Call</th>
              <th>Enrichment</th>
              <th>Affy Call</th>
              <th>Data Source</th>
              <th>Tissue Name</th>
            </tr>
            <!-- DECLARE TABLE HEADERS END -->
            {{#with this}}

              <!-- CREATE ARRAYS FOR AFFY AND TISSUE EXPRESSION DATA START -->
              <script>
                // Metrics for tissue expression graph.
                var tissue_expression_dataset = [];
                tissue_expression_dataset.push(["Tissue Type", "Expression Count"]);
                // Metrics for affy expression graph
                var affy_expression_dataset = [];
                affy_expression_dataset.push(["Mutant", "Expression Count"]);
              </script>
              <!-- CREATE ARRAYS FOR AFFY AND TISSUE EXPRESSION DATA END -->

              {{#each [tissue]}}

                <!-- ADD EXPRESSION DATA TO ARRAY START -->
                <script>
                  tissue_expression_dataset = AddExpressionTuple("{{this.[8]}}", "{{this.[3]}}", tissue_expression_dataset);
                </script>
                <!-- ADD EXPRESSION DATA TO ARRAY END -->

                <!-- DECLARE TABLE BODY START -->
                <tr>
                  <td>{{this.[0]}}<i class= {{this.[6]}} style="float: right"></td> <!-- Add class to display up/down arrow in relation to the up/down expression value -->
                  <td>{{this.[1]}}</td>
                  <td>{{this.[2]}}</td>
                  <td>{{this.[3]}}</td>
                  <td>{{this.[4]}}</td>
                  <td>{{this.[5]}}</td>
                  <td>{{this.[6]}}</td>
                  <td>{{this.[7]}}</td>
                  <td>{{this.[8]}}</td>
                </tr>
                <!-- DECLARE TABLE BODY END -->
              {{/each}}

              <!-- HANDLE CASE WHEN NO MICROARRAY DATA PRESENT FOR GENE START -->
              <script>
                if(!microarray_data_present){
                    Handle_No_Microarray_Data("{{[probe]}}");
                }
                else {
                  affy_expression_dataset = Populate_Microarray_Table(affy_expression_dataset, {{{json [affy]}}}, "{{[probe]}}");
                }
                // STORE GRAPH VALUES FOR USE WHEN RESIZING GOOGLE CHART START
                affy_array.push("{{[probe]}}", affy_expression_dataset); // Push the gene name and associated affy data.
                data_array.push("{{[probe]}}", tissue_expression_dataset); // Push the gene name and the asscoiated expression data.
                  // STORE GRAPH VALUES FOR USE WHEN RESIZING GOOGLE CHART END
              </script>
              <!-- HANDLE CASE WHEN NO MICROARRAY DATA PRESENT FOR GENE END -->

            {{/with}}
          </table>

          <!-- HANDLE CASE WHEN NO TISSUE EXPRESSION DATA PRESENT FOR GENE START -->
          <script>
            if(!tissue_expression_present){
              Handle_No_Tissue_Data("{{[probe]}}");
            }
            else{
              create_tissue_container("{{[probe]}}");
            }
          </script>
          <!-- HANDLE CASE WHEN NO TISSUE EXPRESSION DATA PRESENT FOR GENE END -->
        </div>
        <br>
      </div>
    {{/each}}
  </div>


  <script>
    function toggleSide() { // Toggle side nav open or closed.
      let side = document.getElementById("mySidenav");
      if (side.style.width === "250px") {
        side.style.width = "0px" // Close the sidenav if it was previously open.
      } else {
        side.style.width = "250px" // Open the sidenav if it was previously closed.
        side.style.borderRight = "2px solid black";
      }
    }
    function closeNav() {
      document.getElementById("mySidenav").style.width = "0";
    }
    </script>
</body>
</html>
